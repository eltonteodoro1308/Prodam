SELECT SUM( SE8.E8_SALATUA ) FROM SE8010 SE8

WHERE SE8.D_E_L_E_T_ = ''
AND   SE8.E8_FILIAL  = '01'
AND   SE8.E8_BANCO + SE8.E8_AGENCIA + SE8.E8_CONTA + SE8.E8_DTSALAT IN (

SELECT
  SE8SLD.E8_BANCO   +
  SE8SLD.E8_AGENCIA +
  SE8SLD.E8_CONTA   +
  MAX( SE8SLD.E8_DTSALAT ) E8_DTSALAT

FROM SE8010 SE8SLD

WHERE SE8SLD.D_E_L_E_T_ = ''
AND   SE8SLD.E8_FILIAL = '01'
AND   SE8SLD.E8_DTSALAT <= '20180131'
AND   SE8SLD.E8_BANCO + E8_AGENCIA + E8_CONTA IN ('1042873 191       ', '0011897 590562    ')

GROUP BY SE8SLD.E8_BANCO, SE8SLD.E8_AGENCIA, SE8SLD.E8_CONTA )
		 
--RetSqlName
--FormatIn( <cString>, <cSep> )

-------------------------------
SELECT
  SUM(SE8.E8_SALATUA) E8_SALATUA
FROM SE8010 SE8
WHERE SE8.D_E_L_E_T_ = ''
AND SE8.E8_FILIAL = '01'
AND SE8.E8_BANCO + SE8.E8_AGENCIA + SE8.E8_CONTA + SE8.E8_DTSALAT IN (SELECT
  SE8SLD.E8_BANCO + SE8SLD.E8_AGENCIA + SE8SLD.E8_CONTA + MAX(SE8SLD.E8_DTSALAT) E8_DTSALAT
FROM SE8010 SE8SLD
WHERE SE8SLD.D_E_L_E_T_ = ''
AND SE8SLD.E8_FILIAL = '01'
AND SE8SLD.E8_DTSALAT <= '20181031'
AND SE8SLD.E8_SALATUA <> 0
AND SE8SLD.E8_BANCO + E8_AGENCIA + E8_CONTA IN ('0011897 590562    ', '0011897 5905621   ', '')
GROUP BY SE8SLD.E8_BANCO,
         SE8SLD.E8_AGENCIA,
         SE8SLD.E8_CONTA)